# 3-4. タプル
タプル (tuple) は複数の型の値の組み合わせです．
タプルはコンマ区切りで要素を並べて丸括弧で囲みます．
例えば，```("Brazil", 1985)``` は静的に確保された文字列と整数値のタプルで，その型は ```(&str, i32)``` となります．
タプル ```t``` の各要素には，```t.0``` や ```t.1``` のようにアクセスできます．

一見，タプルと配列は順番に並んだ値のシーケンスとして表されるという点において類似しています．
多くのプログラミング言語では，これらをまとめたり混合したりしていますが，Rust では完全に別のものとして扱います．
1つ目の違いは，配列では全ての要素が同じ型である一方，タプルでは異なる型を取ることができます．
さらに，タプルはインデックスには定数のみを取り，```t.i``` や ```t[i]``` として i 番目の要素にアクセスします．

Rust のコードでは，しばしば関数から複数の値を返す時にタプルを用います．
例えば，文字列の分割を行う ```split_at``` 関数は次のように宣言されています．

```rust
fn split_at(&self, mid: usize) -> (&str, &str);
```

この時，返り値は ```(&str, &str)``` という2つの文字列スライスを含むタプルです．
パターンマッチングの構文を使えば，タプルの各要素をそれぞれ変数に代入することもできます．

```rust
let text = "I see the eigenvalue in thine eye";
let (head, tail) = text.split_at(21);
assert_eq!(head, "I see the eigenvalue ");
assert_eq!(tail, "in thine eye");
```

また，タプルを最小限の構造体型の一種と捉えることもできます．
例えば，第2章の Mandelbrot 集合を扱ったプログラムでは，描画する画像の幅と高さを与える必要がありました．
この時，```height``` と ```width``` というメンバを持つ構造体を定義して渡しても良いのですが，明らかに冗長なのでタプルを使いました．

```rust
/// Write the buffer `pixels`, whose dimensions are given by `bounds`, to the
/// file named `filename`.
fn write_image(filename: &str, pixels: &[u8], bounds: (usize, usize))
    -> Result<(), std::io::Error>
{ ... }
```

上記のコードでは ```bounds``` は ```usize``` 型の値を2つ取るタプル ```(usize, usize)``` です．
この部分を ```width``` と ```height``` という別々のパラメータとして渡すことも可能です．
これは書き方の問題で，画像のサイズは1つの値であると考えて，tapuruでひとまとめにしているというわけです．

他によく使われるタプルとして ゼロタプル (zero-tuple) ```()``` があります．
これは，1つの値しか持たないので，伝統的にユニット型 (unit type) と呼ばれます．
Rust では，型が必要とされているにもかかわらず，意味のある値のやりとりがない場合にユニット型を用います．

例えば，何も値を返さない関数の返り値型は ```()``` となります．
標準ライブラリの ```std::mem::swap``` 関数は，引数の値を入れ替えるだけなので，意味のある返り値を持ちません．
この関数の宣言は次のようになっています．

```rust
fn swap<T>(x: &mut T, y: &mut T);
```

```swap``` 関数は ```<T>``` で指定した型の引数を取ることのできるジェネリックです．
上の記述では返り値の型を示していませんが，これはユニット型の記述を省略したものです．

```rust
fn swap<T>(x: &mut T, y: &mut T) -> ();
```

同様に ```write_image``` 関数の返り値型 ```Result<(), std::io::Error>``` では，エラーが発生した場合には ```std::io::Error``` を返しますが，それ以外の場合には何も値を返しません．

タプルの最後の要素の後に ```(&str, i32,)``` や ```("Brazil", 1985,)``` のようにコンマを挿入することも可能です．
Rust では関数の引数や配列，構造体，列挙体の宣言などで，最後の要素にカンマをつけることを許しています．
人にとっては少々奇妙ではありますが，リストの末尾にエントリが追加されたり削除されたりしたのがわかりやすくなります．

これは要素数が1つのタプルにも共通で，```("lonely hearts",)``` のような記述も可能です．
この時，このタプルの型は ```(&str, )``` となります．
ここでは，最後の神間は単なる括弧で囲んだ表現ではなく，要素数が1つのタプルであることを示すために必要となります．
